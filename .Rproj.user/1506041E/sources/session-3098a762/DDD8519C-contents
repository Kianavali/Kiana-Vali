---
title: "Exploring Age-Related Immune–Vascular Changes in the Brain Using Single-Cell RNA-seq"
---
The brain, once thought to be immunologically privileged, is now recognized as a dynamic immune environment with a diverse array of resident and infiltrating immune cells. Microglia, the brain’s resident macrophages, are central to maintaining homeostasis, while border-associated immune populations—including perivascular macrophages, meningeal dendritic cells, and infiltrating T cells—play critical roles in surveillance and neuroimmune interactions.
## Dataset and Analysis Overview
For my final project, I analyzed single-cell RNA-seq data generated by our lab from young and aged mouse brains. The dataset includes ~20,000 cells per age group, derived from whole-brain single-cell suspensions sorted for live cells and sequenced using the 10x Genomics platform. This analysis focuses on endothelial cells,  macrophages , and T cells— some of the key populations at the brain’s immune–vascular interface. By comparing age-related changes in the expression of adhesion molecules (e.g., ICAM1, VCAM1) and inflammatory mediators (e.g., CXCL10), the project aims to uncover how aging alters immune signaling and vascular function. 
```{r}
#read data file

library(readxl)
DEG_data <- read_excel("DEG_All_Condition_All_CellType 1.xlsx", sheet = 1)

```

```{r}
library(dplyr)
#head

# Define the cell types you want to keep
cell_types <- c("Endothelial_cells", "Macrophages", "T_memory_cells")

# Filter the DEG dataset to keep only these 2 cell types
filtered_deg <- DEG_data %>%
  filter(Cluster %in% cell_types)

# Check how many gene comparisons exist for each selected cell type
table(filtered_deg$Cluster)
```

```{r}
young_vs_aged <- filtered_deg %>%
  filter(ident.1 == "G2_old", ident.2 == "G1_young")
table(young_vs_aged$Cluster)
```

```{r}
library(dplyr)
library(ggplot2)

# Step 1: Broader inflammation/immune gene panel
inflammatory_genes <- c(
  "Il1b", "Il6", "Tnf", "Ifng", 
  "Ccl2", "Ccl3", "Ccl4", "Cxcl9", "Cxcl10",
  "Cd74", "Cd80", "Cd86", "Cd274", "Pdcd1lg2",
  "H2-Ab1", "H2-Aa", "H2-Eb1", "Tap1", "Tapbp",
  "Icam1", "Vcam1", "Sele", "Sell", 
  "Lyz2", "Nos2", "Ptprc"
)

# Step 2: Filter for the genes and relevant cell types
cell_types_focus <- c("Endothelial_cells", "Macrophages", "T_memory_cells")

inflamm_subset <- DEG_data %>%
  filter(Cluster %in% cell_types_focus,
         gene_symbol %in% inflammatory_genes,
         ident.1 == "G2_old", ident.2 == "G1_young")  # ensure aged vs young only

# Step 3: Plot as ggplot heatmap
ggplot(inflamm_subset, aes(x = Cluster, y = gene_symbol, fill = avg_log2FC)) +
  geom_tile(color = "white") +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,
                       name = "log2FC") +
  labs(title = "Log2 Fold Change of Broad Inflammatory Genes (Aged vs. Young)",
       x = "Cell Type", y = "Gene") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        panel.grid = element_blank())
```
## Gene Function Summary

These genes were selected for their roles in inflammation, immune regulation, or endothelial interactions relevant to brain aging:

| **Gene**  | **Function** |
|-----------|--------------|
| **Vcam1** | Endothelial adhesion molecule involved in leukocyte binding and transmigration |
| **Tnf**   | Master pro-inflammatory cytokine activating NF-κB and other immune pathways |
| **Tapbp** | Tapasin; involved in MHC class I antigen processing and presentation |
| **Sell**  | L-selectin; mediates immune cell migration to lymphoid and inflamed tissues |
| **Sele**  | E-selectin; recruits neutrophils and monocytes to sites of inflammation |
| **Ptprc** | CD45; essential for T and B cell activation and signaling |
| **Nos2**  | iNOS; produces nitric oxide in macrophages for microbial defense |
| **Lyz2**  | Antimicrobial enzyme produced by macrophages and neutrophils |
| **Icam1** | Endothelial adhesion molecule involved in immune-endothelial interactions |
| **Cd274** | PD-L1; immune checkpoint molecule that suppresses T cell activation |
| **Ccl4**  | Chemokine that recruits monocytes, T cells, and NK cells to inflamed tissue |

```{r}


```

```{r}

```

