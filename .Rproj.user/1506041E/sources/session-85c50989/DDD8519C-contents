---
title: "Brain inflammaging scRNA seq"
---

About this site
```{r}
#read data file

library(readxl)
DEG_data <- read_excel("DEG_All_Condition_All_CellType 1.xlsx", sheet = 1)

```

```{r}
library(dplyr)

# Define the cell types you want to keep
cell_types <- c("Endothelial_cells", "Macrophages", "T_memory_cells")

# Filter the DEG dataset to keep only these 2 cell types
filtered_deg <- DEG_data %>%
  filter(Cluster %in% cell_types)

# Check how many gene comparisons exist for each selected cell type
table(filtered_deg$Cluster)
```

```{r}
young_vs_aged <- filtered_deg %>%
  filter(ident.1 == "G2_old", ident.2 == "G1_young")
table(young_vs_aged$Cluster)
```

```{r}
library(dplyr)
library(ggplot2)

# Step 1: Broader inflammation/immune gene panel
inflammatory_genes <- c(
  "Il1b", "Il6", "Tnf", "Ifng", 
  "Ccl2", "Ccl3", "Ccl4", "Cxcl9", "Cxcl10",
  "Cd74", "Cd80", "Cd86", "Cd274", "Pdcd1lg2",
  "H2-Ab1", "H2-Aa", "H2-Eb1", "Tap1", "Tapbp",
  "Icam1", "Vcam1", "Sele", "Sell", 
  "Lyz2", "Nos2", "Ptprc"
)

# Step 2: Filter for the genes and relevant cell types
cell_types_focus <- c("Endothelial_cells", "Macrophages", "T_memory_cells")

inflamm_subset <- DEG_data %>%
  filter(Cluster %in% cell_types_focus,
         gene_symbol %in% inflammatory_genes,
         ident.1 == "G2_old", ident.2 == "G1_young")  # ensure aged vs young only

# Step 3: Plot as ggplot heatmap
ggplot(inflamm_subset, aes(x = Cluster, y = gene_symbol, fill = avg_log2FC)) +
  geom_tile(color = "white") +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,
                       name = "log2FC") +
  labs(title = "Log2 Fold Change of Broad Inflammatory Genes (Aged vs. Young)",
       x = "Cell Type", y = "Gene") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        panel.grid = element_blank())
```

```{r}


```

```{r}

```

