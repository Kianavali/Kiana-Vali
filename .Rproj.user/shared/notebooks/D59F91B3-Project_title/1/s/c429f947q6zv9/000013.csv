"0",""
"0","# ðŸ“Š Define and clean top 5 DEGs per cluster"
"0","top5_both <- DEG_data %>%"
"0","  filter(Cluster %in% cell_types,"
"0","         ident.1 == ""G2_old"", ident.2 == ""G1_young"","
"0","         avg_log2FC != 0) %>%"
"0","  # Remove uninformative predicted/missing genes"
"0","  filter(!grepl(""^Gm|^Rik|^ENSMUSG"", gene_symbol)) %>%"
"0","  mutate(display_gene = ifelse(is.na(gene_symbol) | gene_symbol == """", gene_symbol, gene_symbol)) %>%"
"0","  group_by(Cluster) %>%"
"0","  slice_max(order_by = avg_log2FC, n = 5, with_ties = FALSE) %>%"
"0","  mutate(direction = ""Up (old vs young)"") %>%"
"0","  bind_rows("
"0","    DEG_data %>%"
"0","      filter(Cluster %in% cell_types,"
"0","             ident.1 == ""G2_old"", ident.2 == ""G1_young"","
"0","             avg_log2FC != 0) %>%"
"0","      filter(!grepl(""^Gm|^Rik|^ENSMUSG"", gene_symbol)) %>%"
"0","      mutate(display_gene = ifelse(is.na(gene_symbol) | gene_symbol == """", gene_symbol, gene_symbol)) %>%"
"0","      group_by(Cluster) %>%"
"0","      slice_min(order_by = avg_log2FC, n = 5, with_ties = FALSE) %>%"
"0","      mutate(direction = ""Down (old vs young)"")"
"0","  ) %>%"
"0","  ungroup() %>%"
"0","  mutate(p_val_adj = signif(p_val_adj, 3)) %>%"
"0","  arrange(Cluster, desc(avg_log2FC))"
"0",""
"0","# ðŸ“‹ Table"
"0","top5_both %>%"
"0","  select(Cluster, display_gene, avg_log2FC, p_val_adj, direction) %>%"
"0","  kable(format = ""html"", digits = 2,"
"0","        caption = ""Top 5 Up & Down Genes per Cell Type (Based on Fold Change)"")"
