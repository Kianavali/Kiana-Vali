"0","library(dplyr)"
"0","library(tidyr)"
"0","library(ggplot2)"
"0","library(forcats)"
"0",""
"0","cell_types_focus <- c(""Endothelial_cells"", ""Macrophages"", ""T_memory_cells"")"
"0",""
"0","sig_deg <- DEG_data %>%"
"0","  filter(Cluster %in% cell_types_focus,"
"0","         ident.1 == ""G2_old"", ident.2 == ""G1_young"","
"0","         p_val_adj < 0.05)"
"0",""
"0","top_up   <- sig_deg %>%"
"0","  group_by(Cluster) %>%"
"0","  slice_max(order_by = avg_log2FC, n = 10, with_ties = FALSE) %>%"
"0","  mutate(direction = ""Up (old vs young)"")"
"0",""
"0","top_down <- sig_deg %>%"
"0","  group_by(Cluster) %>%"
"0","  slice_min(order_by = avg_log2FC, n = 10, with_ties = FALSE) %>%"
"0","  mutate(direction = ""Down (old vs young)"")"
"0",""
"0","top10_both <- bind_rows(top_up, top_down) %>%"
"0","  arrange(Cluster, desc(avg_log2FC))"
"0",""
"0","top10_both"
