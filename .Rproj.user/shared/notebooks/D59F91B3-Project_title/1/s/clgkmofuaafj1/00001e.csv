"0","library(dplyr)"
"0","library(ggplot2)"
"0",""
"0","# Step 1: Broader inflammation/immune gene panel"
"0","inflammatory_genes <- c("
"0","  ""Il1b"", ""Il6"", ""Tnf"", ""Ifng"", "
"0","  ""Ccl2"", ""Ccl3"", ""Ccl4"", ""Cxcl9"", ""Cxcl10"","
"0","  ""Cd74"", ""Cd80"", ""Cd86"", ""Cd274"", ""Pdcd1lg2"","
"0","  ""H2-Ab1"", ""H2-Aa"", ""H2-Eb1"", ""Tap1"", ""Tapbp"","
"0","  ""Icam1"", ""Vcam1"", ""Sele"", ""Sell"", "
"0","  ""Lyz2"", ""Nos2"", ""Ptprc"""
"0",")"
"0",""
"0","# Step 2: Filter for the genes and relevant cell types"
"0","cell_types_focus <- c(""Endothelial_cells"", ""Macrophages"", ""T_memory_cells"")"
"0",""
"0","inflamm_subset <- DEG_data %>%"
"0","  filter(Cluster %in% cell_types_focus,"
"0","         gene_symbol %in% inflammatory_genes,"
"0","         ident.1 == ""G2_old"", ident.2 == ""G1_young"")  # ensure aged vs young only"
"0",""
"0","# Step 3: Plot as ggplot heatmap"
"0","ggplot(inflamm_subset, aes(x = Cluster, y = gene_symbol, fill = avg_log2FC)) +"
"0","  geom_tile(color = ""white"") +"
"0","  scale_fill_gradient2(low = ""blue"", mid = ""white"", high = ""red"", midpoint = 0,"
"0","                       name = ""log2FC"") +"
"0","  labs(title = ""Log2 Fold Change of Broad Inflammatory Genes (Aged vs. Young)"","
"0","       x = ""Cell Type"", y = ""Gene"") +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1),"
"0","        panel.grid = element_blank())"
