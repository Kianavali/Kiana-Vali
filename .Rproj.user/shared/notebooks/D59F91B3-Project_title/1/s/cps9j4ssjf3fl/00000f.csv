"0","# Filter for memory T cells aged vs young"
"0","# Filter and annotate memory T cells DEG (aged vs young) with relaxed thresholds"
"0","memory_tcell_deg <- DEG_data %>%"
"0","  filter(Cluster == ""memory_T_cells"",       # Double check this name using unique(DEG_data$Cluster)"
"0","         ident.1 == ""G2_old"", "
"0","         ident.2 == ""G1_young"") %>%"
"0","  mutate(log10_pval = -log10(p_val_adj),"
"0","         regulation = case_when("
"0","          p_val_adj < 0.2 & avg_log2FC > 0.1 ~ ""Upregulated"","
"0","           p_val_adj < 0.2 & avg_log2FC < -0.1 ~ ""Downregulated"","
"0","           TRUE ~ ""Not significant"""
"0","         ))"
"0",""
"0","# Volcano plot"
"0","ggplot(memory_tcell_deg, aes(x = avg_log2FC, y = log10_pval)) +"
"0","  geom_point(aes(color = regulation), alpha = 0.7, size = 2) +"
"0","  scale_color_manual(values = c("
"0","    ""Upregulated"" = ""firebrick2"","
"0","    ""Downregulated"" = ""dodgerblue3"","
"0","    ""Not significant"" = ""grey70"""
"0","  )) +"
"0","  geom_vline(xintercept = c(-0.25, 0.25), linetype = ""dashed"", color = ""gray50"") +"
"0","  geom_hline(yintercept = -log10(0.1), linetype = ""dashed"", color = ""gray50"") +"
"0","  labs(title = ""Volcano Plot: Memory T Cells (Aged vs Young)"","
"0","       x = ""log2 Fold Change"","
"0","       y = ""-log10 Adjusted p-value"","
"0","       color = ""Regulation"") +"
"0","  theme_minimal(base_size = 13) +"
"0","  theme(legend.position = ""top"")"
"0",""
