"0",""
"0","# Step 1: Define inflammatory/immune gene panel"
"0","inflammatory_genes <- c("
"0","  ""Il1b"", ""Il6"", ""Tnf"", ""Ifng"", "
"0","  ""Ccl2"", ""Ccl3"", ""Ccl4"", ""Cxcl9"", ""Cxcl10"","
"0","  ""Cd74"", ""Cd80"", ""Cd86"", ""Cd274"", ""Pdcd1lg2"","
"0","  ""H2-Ab1"", ""H2-Aa"", ""H2-Eb1"", ""Tap1"", ""Tapbp"","
"0","  ""Icam1"", ""Vcam1"", ""Sele"", ""Sell"", "
"0","  ""Lyz2"", ""Nos2"", ""Ptprc"","
"0","  ""March1"", ""Marchf1"", ""Fam49b"", ""Qki"", ""Niban1"""
"0",")"
"0",""
"0","# Step 2: Filter DEG data"
"0","inflamm_subset <- DEG_data %>%"
"0","  filter("
"0","    Cluster %in% cell_types,"
"0","    gene_symbol %in% inflammatory_genes,"
"0","    ident.1 == ""G2_old"", ident.2 == ""G1_young"","
"0","    !is.na(avg_log2FC)"
"0","  )"
"0",""
"0","# Step 3: Plot heatmap"
"0","ggplot(inflamm_subset, aes(x = Cluster, y = gene_symbol, fill = avg_log2FC)) +"
"0","  geom_tile(color = ""white"") +"
"0","  scale_fill_gradient2("
"0","    low = ""blue"", mid = ""white"", high = ""red"","
"0","    midpoint = 0,"
"0","    limits = c(-10, 10),"
"0","    oob = scales::squish,"
"0","    name = ""log2FC"""
"0","  ) +"
"0","  labs("
"0","    title = ""Log2 Fold Change of Inflammatory Genes (Aged vs. Young)"","
"0","    x = ""Cell Type"", y = ""Gene"""
"0","  ) +"
"0","  theme_minimal(base_size = 12) +"
"0","  theme("
"0","    axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 10),"
"0","    panel.grid = element_blank()"
"0","  )"
