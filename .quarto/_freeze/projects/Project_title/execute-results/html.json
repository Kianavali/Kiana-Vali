{
  "hash": "7a04a1d53312f247d3d81e2bd7b92c3c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Brain inflammaging scRNA seq\"\n---\n\n\n\nAbout this site\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#read data file\n\nlibrary(readxl)\nDEG_data <- read_excel(\"DEG_All_Condition_All_CellType 1.xlsx\", sheet = 1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\n#head\n\n# Define the cell types you want to keep\ncell_types <- c(\"Endothelial_cells\", \"Macrophages\", \"T_memory_cells\")\n\n# Filter the DEG dataset to keep only these 2 cell types\nfiltered_deg <- DEG_data %>%\n  filter(Cluster %in% cell_types)\n\n# Check how many gene comparisons exist for each selected cell type\ntable(filtered_deg$Cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nEndothelial_cells       Macrophages    T_memory_cells \n            64413             16803              6767 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nyoung_vs_aged <- filtered_deg %>%\n  filter(ident.1 == \"G2_old\", ident.2 == \"G1_young\")\ntable(young_vs_aged$Cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nEndothelial_cells       Macrophages    T_memory_cells \n            10813               477               524 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Step 1: Broader inflammation/immune gene panel\ninflammatory_genes <- c(\n  \"Il1b\", \"Il6\", \"Tnf\", \"Ifng\", \n  \"Ccl2\", \"Ccl3\", \"Ccl4\", \"Cxcl9\", \"Cxcl10\",\n  \"Cd74\", \"Cd80\", \"Cd86\", \"Cd274\", \"Pdcd1lg2\",\n  \"H2-Ab1\", \"H2-Aa\", \"H2-Eb1\", \"Tap1\", \"Tapbp\",\n  \"Icam1\", \"Vcam1\", \"Sele\", \"Sell\", \n  \"Lyz2\", \"Nos2\", \"Ptprc\"\n)\n\n# Step 2: Filter for the genes and relevant cell types\ncell_types_focus <- c(\"Endothelial_cells\", \"Macrophages\", \"T_memory_cells\")\n\ninflamm_subset <- DEG_data %>%\n  filter(Cluster %in% cell_types_focus,\n         gene_symbol %in% inflammatory_genes,\n         ident.1 == \"G2_old\", ident.2 == \"G1_young\")  # ensure aged vs young only\n\n# Step 3: Plot as ggplot heatmap\nggplot(inflamm_subset, aes(x = Cluster, y = gene_symbol, fill = avg_log2FC)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0,\n                       name = \"log2FC\") +\n  labs(title = \"Log2 Fold Change of Broad Inflammatory Genes (Aged vs. Young)\",\n       x = \"Cell Type\", y = \"Gene\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1),\n        panel.grid = element_blank())\n```\n\n::: {.cell-output-display}\n![](Project_title_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Gene Function Summary\n\nThese genes were selected for their roles in inflammation, immune regulation, or endothelial interactions relevant to brain aging:\n\n| **Gene**  | **Function** |\n|-----------|--------------|\n| **Vcam1** | Endothelial adhesion molecule involved in leukocyte binding and transmigration |\n| **Tnf**   | Master pro-inflammatory cytokine activating NF-ÎºB and other immune pathways |\n| **Tapbp** | Tapasin; involved in MHC class I antigen processing and presentation |\n| **Sell**  | L-selectin; mediates immune cell migration to lymphoid and inflamed tissues |\n| **Sele**  | E-selectin; recruits neutrophils and monocytes to sites of inflammation |\n| **Ptprc** | CD45; essential for T and B cell activation and signaling |\n| **Nos2**  | iNOS; produces nitric oxide in macrophages for microbial defense |\n| **Lyz2**  | Antimicrobial enzyme produced by macrophages and neutrophils |\n| **Icam1** | Endothelial adhesion molecule involved in immune-endothelial interactions |\n| **Cd274** | PD-L1; immune checkpoint molecule that suppresses T cell activation |\n| **Ccl4**  | Chemokine that recruits monocytes, T cells, and NK cells to inflamed tissue |\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "Project_title_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}